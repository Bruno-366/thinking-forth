%% Thinking Forth style

\typeout{Thinking Forth Style [28aug04py]}

% stuff left to Bernd:

% chapter title page
% page footer
% section and subsection header style
% caption style

\makeatletter

\setcounter{secnumdepth}{0}
\newcommand{\fixme}[1]{{\tiny$\triangleright$\marginpar{\tiny$\triangleleft$!!#1}}}

\newcommand{\labelsect}[1]{\label{sect-#1}}
\newcommand{\labelfig}[1]{\label{fig-#1}}
\newcommand{\figref}[1]{\ref{fig-#1}}
\newcommand{\fig}[1]{Figure~\figref{#1}}
\newcommand{\Fig}[1]{Figure~\figref{#1}}
\newcommand{\sect}[1]{Section~\ref{sect-#1}}
\newcommand{\Sect}[1]{Section~\ref{sect-#1}}

%\wepsfig{label}{caption}
\newcommand{\wepsfig}[2]{\begin{figure}[hhhh]\caption{#2}\labelfig{#1}eps file missing\end{figure}}
\newcommand{\wepsfiga}[2]{
\begin{figure*}[hhhh]
\caption{#2}
\vspace{1ex}
\centerline{\epsffile{#1.eps}}\vspace{1ex}
\label{fig-#1}
\end{figure*}
}
\newcommand{\wepsfigt}[2]{
\begin{figure*}[tttt]
\caption{#2}
\vspace{1ex}
\centerline{\epsffile{#1.eps}}\vspace{1ex}
\label{fig-#1}
\end{figure*}
}
\newcommand{\wepsfigx}[1]{
\begin{figure*}[tttt]
\vspace{1ex}
\centerline{\epsffile{#1.eps}}\vspace{1ex}
\label{fig-#1}
\end{figure*}
}

\newenvironment{tip}{\list{}{
\hbox{\hbox to\leftmargin{}{\advance\linewidth-1\leftmargin\hbox to \linewidth{\leaders\hrule\@height 1pt\hfill}}}\nopagebreak
\vspace{1ex}{\parindent 2.5em\Large TIP} \nopagebreak}%
  \nopagebreak\item\relax}
{\par\nopagebreak\vspace{1ex}
\nopagebreak\kern-1ex\hbox{\hbox to\leftmargin{}\hbox to \linewidth{\leaders\hrule\@height 1pt\hfill}}
\endlist}

\newenvironment{tfquot}
               {\list{}{\listparindent 1.5em%
                        \itemindent    \listparindent
                        \parsep        \z@ \@plus\p@\small}%
                \item\relax}
               {\endlist}


%\pointto{box}
\newcommand{\pointto}[1]{\raisebox{-1.8ex}[0pt][0pt]{\makebox[0pt][l]{\texttt{\^{ }}}}#1}


%\fwbox{text} %like fbox, but does not create a wider box
\newcommand{\fwbox}[1]{\framebox[\width]{#1}}


%!! in the '94 edition (and probably the original) inline Forth words are
%set in a roman font; if you change \forth to do this, make sure that > and
%< get the correct glyphs
%\forth{words} %used within text paragraphs
\newcommand{\forth}[1]{\texttt{#1}}

%\code text was originally also set in roman font
%\code{text}
\newcommand{\code}[1]{\texttt{#1}}

%\chapternum{THREE}
\newcommand{\chapternum}[1]{}

\newcounter{screen}
\DefineVerbatimEnvironment{Screen}{Verbatim}{frame=single,framesep=3pt,%
label=[{\rm Screen \# \arabic{screen}\stepcounter{screen}}],%
labelposition=topline,numbers=left,firstnumber=0,numbersep=3pt,%
samepage=true,xleftmargin=0em,xrightmargin=0em}

%\lstloadaspects{labels}
%\lstset{language=Forth,basicstyle=\ttfamily,keywordstyle=\bfseries,%
%basewidth=0.5em,frame=tlbr,frameround=tttt,%
%fancyvrb=true% set this to true if you want fancyvrb use
%}

%% chapter/section/subsection styles

\newcommand\HUGE{\@setfontsize\HUGE{40}{50}}

\def\@makechapterhead#1{{\HUGE\sffamily\bfseries\slshape
  \vbox{\hrule \@height 2pt
    \vspace*{1ex}\hbox to \textwidth{\wordchapter}\vspace*{1ex}
    \hrule \@height 2pt}
  \vspace*{100pt}
  \hbox{\hbox to .1\linewidth{}
  \vbox{\hsize.8\linewidth
    \parindent\z@\hyphenpenalty 10000\raggedright
  #1}}
  \vspace*{1em plus 1fill}
  \pagebreak
  \vspace*{1.7in}\hrule\vspace{10pt}
}}

\def\ps@headings{\let\@mkboth\markboth
  \def\@oddhead{}
  \def\@evenhead{}
  \def\@evenfoot{\hss\vbox{\hsize\textwidth
      \hbox to \textwidth{\hbox to 0pt{\hss\hbox to .66in{\sf\bfseries\thepage\hss}}%
        \vrule height0pt depth3.2pt width 0pt%
        {\kern-.33in\small\sf\leftmark}\hfil}}}
  \def\@oddfoot{\hss\vbox{\hsize\textwidth
      \hbox to \textwidth{%
        \hfil\vrule height0pt depth3.2pt width 0pt{{\small\sf\leftmark}\kern-.33in}%
        \hbox to 0pt{\hbox to .66in{\hss\sf\bfseries\thepage}\hss}}}}
  \def\chaptermark##1{\markboth{##1}{##1}}%
  \def\sectionmark##1{\markright{##1}}%
  \def\subsectionmark##1{\markright{##1}}%
}

\ps@headings
\def\ps@plain{\ps@empty}

\def\wordchapter{\ifcase\c@chapter\or ONE\or TWO\or THREE\or FOUR\or
FIVE\or SIX\or SEVEN\or EIGHT\or NINE\or TEN\fi\hss}

\renewcommand\appendix{\par
  \setcounter{chapter}{0}%
  \setcounter{section}{0}%
  \gdef\wordchapter{\appendixname\hss\@Alph\c@chapter}}

\def\raggedlr{\noindent\ifodd\c@page\raggedleft \else\raggedright\fi}

\def\section#1{\vspace*{50pt}\goodbreak\vspace{-50pt}\@startsection{section}{1}{-.66in}{2.5ex plus 1ex 
    minus .2ex}{2ex plus .2ex}{\Large\sf\bfseries\slshape}[#1]{\protect\raggedlr #1\kern-.66in}}
\def\subsection#1{\vspace*{50pt}\goodbreak\vspace{-50pt}\@startsection{subsection}{2}{0in}{2ex plus 1ex
    minus .2ex}{1.5ex \relax}{\large\sf\bfseries}[#1]{\protect\raggedlr #1\kern0in}}
\def\subsubsection#1{\vspace*{50pt}\goodbreak\vspace{-50pt}\@startsection{subsubsection}{3}{0in}{2ex plus 1ex
    minus .2ex}{1.5ex \relax}{\sf\bfseries}[#1]{\protect\raggedlr #1\kern0in}}

\parindent 2.5em

%% caption style

\long\def\@makecaption#1#2{%
  \vskip\abovecaptionskip
  \sbox\@tempboxa{{\bf #1:} {\it #2}}%
  \ifdim \wd\@tempboxa >\hsize
    #1: #2\par
  \else
    \global \@minipagefalse
    \hb@xt@\hsize{\hfil\box\@tempboxa\hfil}%
  \fi
  \vskip\belowcaptionskip}

\makeatother