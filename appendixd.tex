%% Thinking Forth
%% Copyright (C) 2004 Leo Brodie
%% Initial transcription by Ed Beroset
%% 
%% Chapter: Appendix D, Answers to "Further Thinking" Problems
\chapter{
Answers~to 
``Further~Thinking''
Problems}
\section{Chapter 3}
\newcounter{exercise}
\begin{list}%
{\arabic{exercise}.}{\usecounter{exercise}
    \setlength{\rightmargin}{\leftmargin}}
\item The answer depends on whether you believe that other components will
need to ``know the numeric code associated with each key.  Usually this
would \emph{not} be the case.  The simpler, more compact form is therefore
preferable.  Also in the first version, to add a new key would require a 
change in two places.
\item The problem with the words RAM-ALLOT and THERE are that they are 
\emph{time-dependent}:  we must execute them ina particular order.  Our solution
then will be to devise an interface to the RAM allocation pointer that is not
dependent on order; the way to do this is to have a \emph{single} word which does
both functions transparently.

Our word's syntax will be
\begin{verbatim}
: RAM-ALLOT   ( #bytes-to-allot -- starting-adr) 
    ... ;
\end{verbatim}
This syntax will remain the same whether we define it to allocate growing 
upward:
\begin{verbatim}
: RAM-ALLOT  ( #bytes-to-allot -- starting-adr)
    >RAM @  DUP ROT +  >RAM ! ;
\end{verbatim}
or to allocate growing downward:
\begin{verbatim}
: RAM-ALLOT  ( #bytes-to-allot -- starting-adr)
    >RAM @  SWAP -  DUP >RAM ! ;
\end{verbatim}
\end{list}

\section{Chapter 4}
\setcounter{exercise}{3}
\begin{list}%
{\arabic{exercise}.}{\usecounter{exercise}
    \setlength{\rightmargin}{\leftmargin}}
\item Our solution is as follows:
\begin{verbatim}
\ CARDS               Shuffle                   6-20-83
52 CONSTANT #CARDS
CREATE DECK  #CARDS ALLOT   \   one card per byte
: INIT-DECK
   #CARDS 0 DO  I  DECK I + C!  LOOP ;
INIT-DECK
: 'CSWAP  ( a1 a2 -- )  \  swap bytes at a1 and a2
   2DUP C@  SWAP C@  ROT C!  SWAP C! ;
: SHUFFLE   \  shuffle deck of cards
   #CARDS 0 DO  DECK I +  DECK  #CARDS CHOOSE +
      'CSWAP  LOOP ;
\end{verbatim}
\end{list}
\section{Chapter 8}
\setcounter{exercise}{0}
\begin{list}%
{\arabic{exercise}.}{\usecounter{exercise}
    \setlength{\rightmargin}{\leftmargin}}
\item This will work:
\begin{verbatim}
    20 CHOOSE  2 CHOOSE  IF NEGATE THEN
\end{verbatim}
But this is simpler:
\begin{verbatim}
    40 CHOOSE  20 -
\end{verbatim}
\end{list}
