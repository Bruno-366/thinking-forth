%% Thinking Forth
%% Copyright (C) 2004 Leo Brodie
%% Initial transcription by Ed Beroset
%% 
%% test harness
%% pdflatex harness

\newif\ifpdf
\ifx\pdfoutput\undefined
  \pdffalse % we are not running PDFLaTeX
\else
  \pdfoutput=1 % we are running PDFLaTeX
  \pdftrue
\fi

\input{tfoptions}
\input{pagecount}

\ifpdf
\documentclass[10pt,\tflang,pdftex]{book}
\else
\documentclass[10pt,\tflang,dvips]{book}
\fi

\usepackage[T1]{fontenc}
\usepackage[latin1]{inputenc}
\usepackage{graphics}
\usepackage{babel}
\usepackage{geometry}
\usepackage{pst-all}
\usepackage{fancyvrb}
\usepackage[\tfoptions]{tf}

%% Cover creation howto:
%% back | spine | front + border
%% spine = pages*0.0041in
%% border: 0.25in

\newdimen\pwidth
\newdimen\pheight
\newdimen\oldpwidth
\newdimen\twidth
\newdimen\evenmargin
\newdimen\oddmargin
\oldpwidth\paperwidth
\twidth\textwidth
\oddmargin1in
\advance\oddmargin\evensidemargin
\advance\evenmargin\paperwidth
\advance\evenmargin-\twidth
\advance\evenmargin-\oddmargin
\newdimen\spine
\spine0.5\pthick
\spine\pagecount\spine
\pwidth2\paperwidth
\advance\pwidth\spine
\advance\pwidth2\cborder
\pheight\paperheight
\advance\pheight2\cborder

\geometry{verbose,paperwidth=\pwidth,paperheight=\pheight,tmargin=0pt,%
bmargin=0pt,lmargin=0pt,rmargin=0pt,headheight=0pt,headsep=0pt,%
footskip=0pt}

% for pdflatex
\ifpdf
\DeclareGraphicsExtensions{.pdf,.png,.jpg}
\else
\DeclareGraphicsExtensions{.eps}
\fi

\makeatletter
\advance\pheight-2\cborder
\parindent0pt
\begin{document}
\pagestyle{empty}
\centerline{\psframebox*[fillcolor=black,framesep=\cborder]{\noindent
\hbox{\white
\begin{minipage}{\oldpwidth}%
\advance\leftskip\oddmargin
\vbox to\pheight{\vspace{0.5in}%
\begin{minipage}{\twidth}%
\parindent2.5em\sf
\input{backpage}
\end{minipage}
\vss
\psframebox*[fillcolor=white,framesep=.125in]{\includegraphics{isbn}}
\vspace*{0.5in}}
\end{minipage}%
\llap{\smash{\gray\vline height -.5\pheight depth.55\pheight}}%
\llap{\smash{\gray\vline height .55\pheight depth-.51\pheight}}%
\begin{minipage}{\spine}
\ifspineup
\expandafter\rotateleft
\else
\expandafter\rotateright
\fi
{\vbox to \spine{\vss\hbox to \pheight{%
\fontfamily{phv}\selectfont
\noindent\hspace{0.5in}%
\ifspineup
\Huge\bfseries\person{Leo Brodie}\hss\fi
\HUGE\slshape THINKING FORTH\/
\ifspineup\else
    \hss\Huge\bfseries\person{Leo Brodie}%
\fi\hspace{0.5in}%
}\vss}}
\end{minipage}%
\rlap{\smash{\gray\vline height -.5\pheight depth.55\pheight}}%
\rlap{\smash{\gray\vline height .55\pheight depth-.51\pheight}}%
\begin{minipage}{\oldpwidth}%
\vbox to\pheight{\vspace{0.5in}%
    \fontfamily{phv}\selectfont
  \vbox{\hrule \@height 3pt
  \HUGE
    \vspace*{0.2ex}\hbox to \textwidth{\hspace{\evenmargin}\bfseries Leo Brodie\hss}\vspace*{0.2ex}
    \hrule \@height 3pt}%
  \vspace*{100pt}
%%if you want the thinker on the cover, use that:
\ifthinker
  \smash{\lower4.8in\rlap{\hbox to \oldpwidth{%
  \hspace{\evenmargin}\hphantom{\Huge for Solving Problems}\hfill
  \smash{\includegraphics{rodin_thinker}}}\hspace{.125in}}}%
\fi
  \hbox{\hspace{\evenmargin}%
  \begin{minipage}{\twidth}%
    \parindent\z@\hyphenpenalty 10000\raggedright
    {\THUGE\bfseries\slshape THINKING FORTH\\[1em]}%
    \Huge A Language \\ and Philosophy \\ for Solving Problems
  \end{minipage}}
   \vfill
  \hbox{\hspace{\evenmargin}%
  \begin{minipage}{\twidth}%
     \Large\noindent Includes interviews with \Forth{}'s inventor,
\person{Charles H. Moore}, and other \Forth{} thinkers
  \end{minipage}}%
\vspace{0.5in}}%
\end{minipage}}}}%


\end{document}
